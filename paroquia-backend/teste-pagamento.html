<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Teste Pagamento PIX</title>
</head>
<body>
  <h2>Simulação de Pagamento do Dízimo</h2>
  <form id="formPagamento" enctype="multipart/form-data">
    <label>Usuário ID:</label>
    <input type="number" name="usuario_id" value="1" required><br><br>

    <label>Valor:</label>
    <input type="number" step="0.01" name="valor" required><br><br>

    <label>Comprovante:</label>
    <input type="file" name="comprovante" accept="image/*" required><br><br>

    <button type="submit">Enviar Pagamento</button>
  </form>

  <hr>
  <h3>QR Code Gerado:</h3>
  <div id="resultado"></div>

  <script>
  const form = document.getElementById("formPagamento");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = new FormData(form);

    // Adiciona a data atual ao FormData
    const hoje = new Date().toISOString().slice(0, 10); // Formato AAAA-MM-DD
    formData.append('data_pagamento', hoje);

    // O fetch continua igual
    const response = await fetch("http://localhost:8081/pagamentos-dizimo", {
      method: "POST",
      body: formData
      // Não adicione o header 'Content-Type', o navegador faz isso automaticamente com FormData
    });

    const data = await response.json();

    // ... resto do script ...
  });
</script>
</body>
</html>
